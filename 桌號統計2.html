<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>桌號統計</title>
<style>
body {
  font-family: "Noto Sans TC", sans-serif;
  background-color: #e6f3ff;
  color: #333;
  margin: 0;
  padding: 0;
  text-align: center;
}
#app {
  padding: 20px;
  max-width: 500px;
  margin: auto;
}
h1 {
  font-size: 22px;
  margin: 10px 0 15px;
  color: #007acc;
}
input {
  width: 80px;
  padding: 8px;
  margin: 5px;
  font-size: 16px;
  border: 1px solid #aaa;
  border-radius: 6px;
}
button {
  padding: 10px 18px;
  margin: 8px 5px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  background-color: #4db3ff;
  color: white;
  cursor: pointer;
}
button:active {
  transform: scale(0.96);
}
#button-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin-top: 10px;
  margin-bottom: 20px;
}
.table-btn {
  background-color: #ffffff;
  border: 2px solid #4db3ff;
  border-radius: 10px;
  padding: 10px 14px;
  font-size: 14px;
  color: #007acc;
  cursor: pointer;
}
.hidden {
  display: none;
}
#top-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}
#stats {
  font-size: 18px;
  font-weight: bold;
  color: #004b80;
}
</style>
</head>
<body>
<div id="app">
  <!-- 設定畫面 -->
  <div id="setup-screen">
    <h1>桌號範圍設定</h1>
    <label>桌號範圍：</label>
    <input type="number" id="startNum" placeholder="起始號">
    <span> ~ </span>
    <input type="number" id="endNum" placeholder="結束號">
    <button id="submitRange">送出</button>
  </div>

  <!-- 主畫面 -->
  <div id="main-screen" class="hidden">
    <div id="top-controls">
      <div>
        <button id="undoBtn">還原上一步</button>
        <button id="resetBtn">返回設定</button>
      </div>
      <div id="stats">剩餘桌次：0</div>
    </div>
    <div id="button-container"></div>
  </div>
</div>

<script>
const setupScreen = document.getElementById("setup-screen");
const mainScreen = document.getElementById("main-screen");
const buttonContainer = document.getElementById("button-container");
const undoBtn = document.getElementById("undoBtn");
const resetBtn = document.getElementById("resetBtn");
const stats = document.getElementById("stats");

let startNum, endNum;
let historyStack = [];

document.getElementById("submitRange").addEventListener("click", () => {
  startNum = parseInt(document.getElementById("startNum").value);
  endNum = parseInt(document.getElementById("endNum").value);

  if (isNaN(startNum) || isNaN(endNum) || startNum > endNum) {
    alert("請輸入有效的桌號範圍！");
    return;
  }

  setupScreen.classList.add("hidden");
  mainScreen.classList.remove("hidden");

  generateButtons();
});

function generateButtons() {
  buttonContainer.innerHTML = "";
  historyStack = [];

  for (let i = startNum; i <= endNum; i++) {
    const btn = document.createElement("button");
    btn.textContent = i;
    btn.className = "table-btn";
    btn.addEventListener("click", () => removeButton(btn, i));
    buttonContainer.appendChild(btn);
  }

  updateStats();
}

function removeButton(btn, num) {
  const index = [...buttonContainer.children].indexOf(btn);
  historyStack.unshift({ num: num, index: index });
  if (historyStack.length > 10) historyStack.pop();
  btn.remove();
  updateStats();
}

undoBtn.addEventListener("click", () => {
  const last = historyStack.shift();
  if (last) {
    const newBtn = document.createElement("button");
    newBtn.textContent = last.num;
    newBtn.className = "table-btn";
    newBtn.addEventListener("click", () => removeButton(newBtn, last.num));

    if (last.index >= buttonContainer.children.length) {
      buttonContainer.appendChild(newBtn);
    } else {
      buttonContainer.insertBefore(newBtn, buttonContainer.children[last.index]);
    }
    updateStats();
  } else {
    alert("沒有可以還原的動作！");
  }
});

resetBtn.addEventListener("click", () => {
  setupScreen.classList.remove("hidden");
  mainScreen.classList.add("hidden");
  document.getElementById("startNum").value = "";
  document.getElementById("endNum").value = "";
});

function updateStats() {
  const remaining = buttonContainer.children.length;
  stats.textContent = `剩餘桌次：${remaining}`;
}
</script>
</body>
</html>
